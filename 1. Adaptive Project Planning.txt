useEffect(() => {
  if (!gridApi) return;

  const defs = gridApi.getColumnDefs() || [];
  if (!defs.length) return;

  const first = defs[0];
  const nextFirst = {
    ...first,

    // show greyed checkbox only in disabled mode
    showDisabledCheckboxes: (params) => {
      if (isCaseDisabled && !isNewRequest) {
        const list = params?.data?.predefDocs || [];
        return list.some(d => d.documentId === params.data.documentId && d.selected === true);
      }
      return false;
    },

    // allow selecting rows when not disabled (after Claim)
    checkboxSelection: (params) => {
      if (isCaseDisabled && !isNewRequest) {
        const list = params?.data?.predefDocs || [];
        return list.some(d => d.documentId === params.data.documentId && d.selected === true);
      }
      return true;
    },

    headerCheckboxSelection: () => !(isCaseDisabled && !isNewRequest),
    headerClass: () =>
      (isCaseDisabled && !isNewRequest) ? 'pointer-events custom-disabled-checkbox' : '',
  };

  gridApi.setColumnDefs([nextFirst, ...defs.slice(1)]);
  gridApi.refreshHeader();
  gridApi.refreshCells({ force: true, columns: ['nameAndDetailsSearchHelper'] });
}, [isCaseDisabled, isNewRequest, gridApi]);
